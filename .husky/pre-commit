#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Set this variable to 1 to enable fast failing
export FORCE_EXIT_ON_ERROR=1

# Run KYC verification first since it's critical
node scripts/verify-kyc-levels.js || exit 1

# Set this variable to 1 to skip linting step
if [ "$SKIP_LINT" = "1" ]; then
  # Run pre-commit without linting
  node scripts/verify-signatures.js && node scripts/verify-types.js && ./scripts/build-no-proxy.sh && npm run test:precommit
else
  # Run the precommit script which handles linting, formatting, building, and testing
  npm run precommit || exit 1 
fi 